{
  "name": "IntelliGuard-AI Security Incident Template",
  "displayName": "Security Incident Response",
  "description": "Comprehensive security incident response template for IntelliGuard-AI SOC operations",
  "author": "AL NAFI AI-Ops Diploma Project",
  "version": "1.0.0",
  "titlePrefix": "[INTELLIGUARD]",
  "severity": 2,
  "tlp": 2,
  "pap": 2,
  "tags": ["intelliguard-ai", "security-incident", "automated"],
  "customFields": [
    {
      "name": "incident_category",
      "displayName": "Incident Category",
      "type": "string",
      "mandatory": true,
      "options": [
        "malware",
        "ransomware",
        "data_breach",
        "insider_threat",
        "apt",
        "ddos",
        "phishing",
        "credential_theft",
        "lateral_movement",
        "data_exfiltration",
        "other"
      ],
      "description": "Primary category of the security incident"
    },
    {
      "name": "mitre_tactics",
      "displayName": "MITRE ATT&CK Tactics",
      "type": "string",
      "mandatory": false,
      "description": "Observed MITRE ATT&CK tactics (comma-separated)"
    },
    {
      "name": "detection_source",
      "displayName": "Detection Source",
      "type": "string",
      "mandatory": true,
      "options": [
        "wazuh_siem",
        "endpoint_detection",
        "network_monitoring",
        "user_report",
        "threat_intelligence",
        "external_notification",
        "automated_hunting",
        "manual_investigation"
      ],
      "description": "Source that initially detected the incident"
    },
    {
      "name": "automated_response",
      "displayName": "Automated Response Triggered",
      "type": "boolean",
      "mandatory": true,
      "description": "Whether automated response actions were triggered"
    },
    {
      "name": "business_impact",
      "displayName": "Business Impact Level",
      "type": "string",
      "mandatory": true,
      "options": [
        "none",
        "minimal",
        "moderate",
        "significant",
        "severe",
        "critical"
      ],
      "description": "Level of business impact from the incident"
    },
    {
      "name": "affected_systems_count",
      "displayName": "Number of Affected Systems",
      "type": "integer",
      "mandatory": false,
      "description": "Total number of systems affected by the incident"
    },
    {
      "name": "data_classification",
      "displayName": "Data Classification Involved",
      "type": "string",
      "mandatory": false,
      "options": [
        "public",
        "internal",
        "confidential",
        "restricted",
        "pii",
        "phi",
        "pci",
        "unknown"
      ],
      "description": "Highest classification of data potentially involved"
    },
    {
      "name": "compliance_impact",
      "displayName": "Regulatory Compliance Impact",
      "type": "string",
      "mandatory": false,
      "options": [
        "none",
        "gdpr",
        "hipaa",
        "pci_dss",
        "sox",
        "iso27001",
        "multiple",
        "unknown"
      ],
      "description": "Regulatory frameworks potentially impacted"
    }
  ],
  "tasks": [
    {
      "title": "Initial Assessment",
      "description": "Conduct initial assessment of the security incident",
      "order": 1,
      "mandatory": true,
      "group": "detection_analysis",
      "tasks": [
        {
          "title": "Verify Alert Authenticity",
          "description": "Confirm the security alert is genuine and not a false positive",
          "order": 1,
          "mandatory": true
        },
        {
          "title": "Classify Incident Severity",
          "description": "Determine incident severity based on scope and impact",
          "order": 2,
          "mandatory": true
        },
        {
          "title": "Document Initial Findings",
          "description": "Record initial observations and evidence",
          "order": 3,
          "mandatory": true
        },
        {
          "title": "Notify Incident Response Team",
          "description": "Alert appropriate team members based on severity",
          "order": 4,
          "mandatory": true
        }
      ]
    },
    {
      "title": "Containment Actions",
      "description": "Implement immediate containment measures",
      "order": 2,
      "mandatory": true,
      "group": "containment",
      "tasks": [
        {
          "title": "Isolate Affected Systems",
          "description": "Network isolation of compromised systems",
          "order": 1,
          "mandatory": false
        },
        {
          "title": "Disable Compromised Accounts",
          "description": "Disable user accounts showing signs of compromise",
          "order": 2,
          "mandatory": false
        },
        {
          "title": "Block Malicious IPs/Domains",
          "description": "Implement firewall rules to block malicious infrastructure",
          "order": 3,
          "mandatory": false
        },
        {
          "title": "Verify Containment Effectiveness",
          "description": "Confirm containment measures are working",
          "order": 4,
          "mandatory": true
        }
      ]
    },
    {
      "title": "Evidence Collection",
      "description": "Collect and preserve digital evidence",
      "order": 3,
      "mandatory": true,
      "group": "investigation",
      "tasks": [
        {
          "title": "Memory Dump Collection",
          "description": "Collect memory dumps from affected systems",
          "order": 1,
          "mandatory": false
        },
        {
          "title": "Disk Image Acquisition",
          "description": "Create forensic images of affected storage",
          "order": 2,
          "mandatory": false
        },
        {
          "title": "Log Collection",
          "description": "Gather relevant system and security logs",
          "order": 3,
          "mandatory": true
        },
        {
          "title": "Network Traffic Capture",
          "description": "Collect network packet captures if available",
          "order": 4,
          "mandatory": false
        },
        {
          "title": "Chain of Custody Documentation",
          "description": "Document evidence handling procedures",
          "order": 5,
          "mandatory": true
        }
      ]
    },
    {
      "title": "Threat Analysis",
      "description": "Analyze the threat and attack vectors",
      "order": 4,
      "mandatory": true,
      "group": "investigation",
      "tasks": [
        {
          "title": "Malware Analysis",
          "description": "Analyze any malicious software discovered",
          "order": 1,
          "mandatory": false
        },
        {
          "title": "IOC Extraction",
          "description": "Extract indicators of compromise",
          "order": 2,
          "mandatory": true
        },
        {
          "title": "Attribution Analysis",
          "description": "Attempt to identify threat actor or campaign",
          "order": 3,
          "mandatory": false
        },
        {
          "title": "Attack Timeline Construction",
          "description": "Build timeline of attack progression",
          "order": 4,
          "mandatory": true
        },
        {
          "title": "MITRE ATT&CK Mapping",
          "description": "Map observed TTPs to MITRE framework",
          "order": 5,
          "mandatory": true
        }
      ]
    },
    {
      "title": "Impact Assessment",
      "description": "Assess the full scope and impact of the incident",
      "order": 5,
      "mandatory": true,
      "group": "assessment",
      "tasks": [
        {
          "title": "System Impact Analysis",
          "description": "Determine which systems were affected",
          "order": 1,
          "mandatory": true
        },
        {
          "title": "Data Impact Assessment",
          "description": "Identify what data may have been accessed or stolen",
          "order": 2,
          "mandatory": true
        },
        {
          "title": "Business Process Impact",
          "description": "Assess impact on business operations",
          "order": 3,
          "mandatory": true
        },
        {
          "title": "Financial Impact Estimation",
          "description": "Estimate financial losses and costs",
          "order": 4,
          "mandatory": false
        },
        {
          "title": "Regulatory Impact Review",
          "description": "Assess compliance and regulatory implications",
          "order": 5,
          "mandatory": true
        }
      ]
    },
    {
      "title": "Communication Management",
      "description": "Manage internal and external communications",
      "order": 6,
      "mandatory": true,
      "group": "communication",
      "tasks": [
        {
          "title": "Internal Stakeholder Notification",
          "description": "Notify relevant internal stakeholders",
          "order": 1,
          "mandatory": true
        },
        {
          "title": "Legal Team Consultation",
          "description": "Engage legal team for guidance",
          "order": 2,
          "mandatory": false
        },
        {
          "title": "Regulatory Notification Assessment",
          "description": "Determine if regulatory notification is required",
          "order": 3,
          "mandatory": true
        },
        {
          "title": "Customer/Public Communication Plan",
          "description": "Develop external communication strategy if needed",
          "order": 4,
          "mandatory": false
        },
        {
          "title": "Media Response Preparation",
          "description": "Prepare for potential media inquiries",
          "order": 5,
          "mandatory": false
        }
      ]
    },
    {
      "title": "Recovery and Restoration",
      "description": "Restore systems and operations to normal state",
      "order": 7,
      "mandatory": true,
      "group": "recovery",
      "tasks": [
        {
          "title": "System Cleaning and Patching",
          "description": "Remove malware and apply security patches",
          "order": 1,
          "mandatory": false
        },
        {
          "title": "Data Restoration",
          "description": "Restore data from clean backups if necessary",
          "order": 2,
          "mandatory": false
        },
        {
          "title": "Security Control Enhancement",
          "description": "Implement additional security controls",
          "order": 3,
          "mandatory": true
        },
        {
          "title": "System Validation Testing",
          "description": "Test systems before returning to production",
          "order": 4,
          "mandatory": true
        },
        {
          "title": "User Access Restoration",
          "description": "Restore user access with enhanced authentication",
          "order": 5,
          "mandatory": false
        }
      ]
    },
    {
      "title": "Lessons Learned",
      "description": "Document lessons learned and improvements",
      "order": 8,
      "mandatory": true,
      "group": "post_incident",
      "tasks": [
        {
          "title": "Post-Incident Review Meeting",
          "description": "Conduct comprehensive post-incident review",
          "order": 1,
          "mandatory": true
        },
        {
          "title": "Process Improvement Identification",
          "description": "Identify areas for process improvement",
          "order": 2,
          "mandatory": true
        },
        {
          "title": "Security Control Gaps Analysis",
          "description": "Analyze gaps in security controls",
          "order": 3,
          "mandatory": true
        },
        {
          "title": "Training Needs Assessment",
          "description": "Identify additional training requirements",
          "order": 4,
          "mandatory": false
        },
        {
          "title": "Final Report Documentation",
          "description": "Complete comprehensive incident report",
          "order": 5,
          "mandatory": true
        }
      ]
    }
  ],
  "observableTypes": [
    {
      "name": "ip",
      "description": "IP addresses involved in the incident"
    },
    {
      "name": "domain",
      "description": "Domain names involved in the incident"
    },
    {
      "name": "url",
      "description": "URLs involved in the incident"
    },
    {
      "name": "filename",
      "description": "File names involved in the incident"
    },
    {
      "name": "hash",
      "description": "File hashes (MD5, SHA1, SHA256)"
    },
    {
      "name": "email",
      "description": "Email addresses involved in the incident"
    },
    {
      "name": "user-account",
      "description": "User accounts involved in the incident"
    },
    {
      "name": "registry",
      "description": "Windows registry keys"
    },
    {
      "name": "other",
      "description": "Other indicators of compromise"
    }
  ],
  "metrics": [
    {
      "name": "time_to_detection",
      "description": "Time from initial compromise to detection",
      "unit": "minutes"
    },
    {
      "name": "time_to_containment",
      "description": "Time from detection to containment",
      "unit": "minutes"
    },
    {
      "name": "time_to_recovery",
      "description": "Time from containment to full recovery",
      "unit": "hours"
    },
    {
      "name": "false_positive_rate",
      "description": "Rate of false positive alerts",
      "unit": "percentage"
    },
    {
      "name": "automation_rate",
      "description": "Percentage of automated response actions",
      "unit": "percentage"
    }
  ],
  "workflowIntegration": {
    "shuffle": {
      "workflow_ids": [
        "intelliguard-ransomware-response",
        "intelliguard-malware-analysis",
        "intelliguard-data-breach-response"
      ],
      "auto_trigger": true,
      "trigger_conditions": [
        {
          "field": "severity",
          "operator": ">=",
          "value": 2
        },
        {
          "field": "customFields.automated_response",
          "operator": "equals",
          "value": true
        }
      ]
    },
    "cortex": {
      "analyzers": [
        "VirusTotal_GetReport_3_0",
        "Abuse_Finder_3_0",
        "ThreatCrowd_1_0",
        "MaxMind_GeoIP_3_0",
        "MISP_2_1",
        "Yara_2_0"
      ],
      "auto_analyze": true,
      "analyzer_conditions": [
        {
          "observable_type": "ip",
          "analyzers": ["Abuse_Finder_3_0", "MaxMind_GeoIP_3_0"]
        },
        {
          "observable_type": "hash",
          "analyzers": ["VirusTotal_GetReport_3_0", "Yara_2_0"]
        },
        {
          "observable_type": "domain",
          "analyzers": ["ThreatCrowd_1_0", "VirusTotal_GetReport_3_0"]
        }
      ]
    },
    "misp": {
      "auto_publish": false,
      "sharing_group": "intelliguard-internal",
      "threat_level": "high",
      "analysis": "ongoing",
      "distribution": "organization"
    }
  },
  "reportTemplates": [
    {
      "name": "executive_summary",
      "displayName": "Executive Summary Report",
      "description": "High-level summary for executive stakeholders",
      "template": "executive_incident_summary.html",
      "auto_generate": true,
      "recipients": ["ciso@company.com", "cto@company.com"]
    },
    {
      "name": "technical_analysis",
      "displayName": "Technical Analysis Report",
      "description": "Detailed technical analysis for security team",
      "template": "technical_incident_analysis.html",
      "auto_generate": false,
      "recipients": ["security-team@company.com"]
    },
    {
      "name": "regulatory_compliance",
      "displayName": "Regulatory Compliance Report",
      "description": "Report formatted for regulatory requirements",
      "template": "regulatory_compliance_report.html",
      "auto_generate": false,
      "recipients": ["compliance@company.com", "legal@company.com"]
    }
  ],
  "automationRules": [
    {
      "name": "critical_incident_escalation",
      "trigger": {
        "field": "severity",
        "operator": "equals",
        "value": 3
      },
      "actions": [
        {
          "type": "notification",
          "target": "sms",
          "recipients": ["+1234567890"],
          "message": "CRITICAL: Security incident {{case.title}} requires immediate attention"
        },
        {
          "type": "task_assignment",
          "task": "Initial Assessment",
          "assignee": "security-lead@company.com"
        }
      ]
    },
    {
      "name": "automated_ioc_extraction",
      "trigger": {
        "field": "status",
        "operator": "equals",
        "value": "Open"
      },
      "actions": [
        {
          "type": "cortex_analysis",
          "observables": "all",
          "analyzers": ["auto_select"]
        }
      ]
    },
    {
      "name": "compliance_notification",
      "trigger": {
        "field": "customFields.compliance_impact",
        "operator": "not_equals",
        "value": "none"
      },
      "actions": [
        {
          "type": "task_creation",
          "task": {
            "title": "Regulatory Notification Assessment",
            "description": "Assess requirement for regulatory notification based on {{customFields.compliance_impact}}",
            "assignee": "compliance@company.com",
            "due_date": "+4h"
          }
        }
      ]
    }
  ],
  "slaConfiguration": {
    "detection_to_response": {
      "critical": "15m",
      "high": "1h",
      "medium": "4h",
      "low": "24h"
    },
    "containment_time": {
      "critical": "30m",
      "high": "2h",
      "medium": "8h",
      "low": "24h"
    },
    "resolution_time": {
      "critical": "4h",
      "high": "24h",
      "medium": "72h",
      "low": "168h"
    }
  },
  "kpiTracking": {
    "enabled": true,
    "metrics": [
      {
        "name": "mean_time_to_detection",
        "calculation": "average",
        "field": "metrics.time_to_detection",
        "target": 15,
        "unit": "minutes"
      },
      {
        "name": "mean_time_to_containment",
        "calculation": "average",
        "field": "metrics.time_to_containment",
        "target": 30,
        "unit": "minutes"
      },
      {
        "name": "incident_volume",
        "calculation": "count",
        "field": "case_count",
        "period": "daily"
      },
      {
        "name": "false_positive_rate",
        "calculation": "percentage",
        "field": "metrics.false_positive_rate",
        "target": 15,
        "unit": "percentage"
      }
    ]
  },
  "integrationSettings": {
    "wazuh": {
      "api_endpoint": "https://wazuh.company.com:55000",
      "auto_import_alerts": true,
      "severity_mapping": {
        "1-3": "low",
        "4-6": "medium", 
        "7-9": "high",
        "10-15": "critical"
      }
    },
    "elasticsearch": {
      "cluster_endpoint": "https://elasticsearch.company.com:9200",
      "index_pattern": "wazuh-alerts-*",
      "auto_search": true
    },
    "active_directory": {
      "ldap_server": "ldap://dc.company.local",
      "auto_user_lookup": true,
      "group_mapping": true
    }
  },
  "training": {
    "required_certifications": [
      "GCIH",
      "GCFA",
      "GNFA",
      "CISSP"
    ],
    "training_materials": [
      {
        "title": "IntelliGuard-AI Incident Response Procedures",
        "url": "https://training.company.com/intelliguard-ir",
        "mandatory": true
      },
      {
        "title": "MITRE ATT&CK Framework Training",
        "url": "https://attack.mitre.org/resources/training/",
        "mandatory": true
      },
      {
        "title": "Digital Forensics Best Practices",
        "url": "https://training.company.com/digital-forensics",
        "mandatory": false
      }
    ]
  }
}
    